<%- include('../partials/header') %>

<style>
    body {
        background-color: #f5f5f5;
        font-family: 'Poppins', sans-serif;
    }
    
    .admin-container {
        max-width: 1400px;
        margin: 40px auto;
        padding: 20px;
    }
    
    .admin-header {
        background: white;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .admin-header h1 {
        margin: 0;
        color: #333;
        font-size: 32px;
    }
    
    .admin-header p {
        margin: 10px 0 0 0;
        color: #666;
    }
    
    .api-section {
        background: white;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .api-section h2 {
        margin-top: 0;
        color: #333;
        border-bottom: 2px solid #4CAF50;
        padding-bottom: 10px;
    }
    
    .api-endpoint {
        background: #f9f9f9;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
        border-left: 4px solid #4CAF50;
    }
    
    .api-endpoint .method {
        display: inline-block;
        background: #4CAF50;
        color: white;
        padding: 5px 10px;
        border-radius: 3px;
        font-weight: bold;
        margin-right: 10px;
    }
    
    .api-endpoint .url {
        font-family: monospace;
        color: #333;
    }
    
    .api-endpoint .description {
        color: #666;
        margin-top: 5px;
        font-size: 14px;
    }
    
    .btn-test {
        background: #2196F3;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
        font-family: 'Poppins', sans-serif;
    }
    
    .btn-test:hover {
        background: #0b7dda;
    }
    
    .logout-btn {
        background: #f44336;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-family: 'Poppins', sans-serif;
        float: right;
    }
    
    .logout-btn:hover {
        background: #da190b;
    }
</style>

<div class="admin-container">
    <div class="admin-header">
        <h1>üîê Panel de Administraci√≥n</h1>
        <p>Bienvenido, <%= user.email %> | Rol: <strong><%= user.rol %></strong></p>
        <button class="logout-btn" onclick="window.location.href='/logout'">Cerrar Sesi√≥n</button>
    </div>
    
    <div class="api-section">
        <h2>üìã API Endpoints Disponibles</h2>
        
        <div class="api-endpoint">
            <span class="method">GET</span>
            <span class="url">/admin/api/businesses</span>
            <div class="description">Obtiene todos los emprendimientos registrados con sus datos completos</div>
            <button class="btn-test" onclick="testEndpoint('/admin/api/businesses')">Probar</button>
        </div>
        
        <div class="api-endpoint">
            <span class="method">GET</span>
            <span class="url">/admin/api/businesses/:id</span>
            <div class="description">Obtiene un emprendimiento espec√≠fico por ID</div>
            <button class="btn-test" onclick="testEndpointWithId('/admin/api/businesses/')">Probar</button>
        </div>
        
        <div class="api-endpoint">
            <span class="method">GET</span>
            <span class="url">/admin/api/users</span>
            <div class="description">Obtiene todos los usuarios emprendedores registrados</div>
            <button class="btn-test" onclick="testEndpoint('/admin/api/users')">Probar</button>
        </div>
        
        <div class="api-endpoint">
            <span class="method">GET</span>
            <span class="url">/admin/api/statistics</span>
            <div class="description">Obtiene estad√≠sticas generales del sistema</div>
            <button class="btn-test" onclick="testEndpoint('/admin/api/statistics')">Probar</button>
        </div>
    </div>
    
    <div class="api-section">
        <h2>üìä Resultado de la Prueba</h2>
        <div id="result-container" style="background: #f5f5f5; padding: 20px; border-radius: 5px; min-height: 100px;">
            <p style="color: #666; margin: 0;">Haz clic en "Probar" en cualquier endpoint para ver los resultados aqu√≠.</p>
        </div>
    </div>
</div>

<script>
    async function testEndpoint(url) {
        const resultContainer = document.getElementById('result-container');
        resultContainer.innerHTML = '<p style="color: #666;">‚è≥ Cargando...</p>';
        
        try {
            const response = await fetch(url);
            const data = await response.json();
            
            resultContainer.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Status:</strong> ${response.status} ${response.statusText}
                </div>
                <pre style="background: white; padding: 15px; border-radius: 5px; overflow-x: auto;">${JSON.stringify(data, null, 2)}</pre>
            `;
        } catch (error) {
            resultContainer.innerHTML = `<p style="color: #f44336;">‚ùå Error: ${error.message}</p>`;
        }
    }
    
    function testEndpointWithId(baseUrl) {
        const id = prompt('Ingrese el ID del emprendimiento:');
        if (id) {
            testEndpoint(baseUrl + id);
        }
    }
</script>

<%- include('../partials/footer') %>
